<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Raid Halloween Path — Pumpkin Coin Planner</title>
  <style>
    :root{
      --bg:#0e0f13; --card:#161922; --muted:#8b93a7; --txt:#e7ecf3; --accent:#f4a261; --accent2:#e76f51; --warn:#ffb86b; --danger:#ff6b6b;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b0c10,#12141b 50%,#0b0c10);color:var(--txt);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;}
    header{position:sticky;top:0;z-index:10;background:rgba(14,15,19,.7);backdrop-filter:blur(8px);border-bottom:1px solid #222834}
    .wrap{max-width:1000px;margin:0 auto;padding:18px}
    h1{margin:0;font-size:22px;letter-spacing:.2px;color:var(--accent)}

    .summary{display:grid;gap:12px;grid-template-columns:2fr 1fr 1fr 1fr;align-items:stretch;margin:14px 0}
    .card{background:var(--card);border:1px solid #232835;border-radius:16px;padding:14px 16px;box-shadow:0 6px 18px rgba(0,0,0,.25)}
    .card h3{margin:0 0 8px 0;font-weight:600;font-size:13px;color:var(--muted);text-transform:uppercase;letter-spacing:.8px}
    .card .value{font-size:28px;font-weight:800}
    .value small{font-weight:600;color:var(--muted);font-size:13px}

    .progress{height:12px;background:#0f1320;border:1px solid #273047;border-radius:999px;overflow:hidden}
    .progress > div{height:100%;background:linear-gradient(90deg,#f4a261,#e76f51);width:0%;transition:width .25s ease}

    .controls{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin:12px 0}
    .controls input[type="number"], .controls select{background:#0f1320;border:1px solid #273047;border-radius:10px;color:var(--txt);padding:10px 12px;min-width:120px;width:100%}
    label span{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}

    .section{margin:20px 0}
    .panel{background:var(--card);border:1px solid #232835;border-radius:16px;padding:16px}
    .panel h3{margin:0 0 12px 0;font-size:16px;color:var(--accent)}

    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}

    .muted{color:var(--muted);font-size:12px}

    @media (max-width:900px){
      .summary{grid-template-columns:1fr 1fr}
      .controls{grid-template-columns:1fr}
      .grid2,.grid3{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Raid Halloween Path — Pumpkin Coin Planner</h1>
      <div class="summary">
        <div class="card">
          <h3>Goal</h3>
          <div>
            <select id="goalSelect" style="width:100%">
              <option value="18000">18,000 — 1 Key + 25 Frags</option>
              <option value="24000">24,000 — 2nd Key + 25 Frags</option>
              <option value="57500">57,500 — 1 Soul (Raphael/April)</option>
              <option value="115000" selected>115,000 — Both Souls</option>
            </select>
          </div>
          <div class="muted">Or override with a custom target below.</div>
        </div>
        <div class="card">
          <h3>Pumpkin Coins Needed</h3>
          <div class="value"><span id="pointsNeeded">115,000</span></div>
          <div class="progress" style="margin-top:8px"><div id="progressBar"></div></div>
        </div>
        <div class="card">
          <h3>Pumpkin Coins Planned</h3>
          <div class="value" id="currentPoints">0</div>
        </div>
        <div class="card">
          <h3>Remaining</h3>
          <div class="value" id="remainingPoints">115,000</div>
        </div>
      </div>

      <div class="controls">
        <label>
          <span>Custom Target (optional)</span>
          <input type="number" id="targetInput" placeholder="e.g., 115000" min="0" />
        </label>
        <label>
          <span>Current Coins Already Earned</span>
          <input type="number" id="alreadyCoins" placeholder="e.g., 4000" min="0" />
        </label>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="section panel">
      <h3>Dungeon Energy Plan</h3>
      <div class="grid3">
        <label>
          <span>Dragon 10 Hard — Energy Planned</span>
          <input type="number" id="energy10H" min="0" placeholder="e.g., 5000" />
        </label>
        <label>
          <span>Coins per Energy (10H)</span>
          <input type="number" id="cpe10H" min="0" step="0.01" placeholder="editable e.g., 0.85" />
        </label>
        <label>
          <span>Subtotal Coins (10H)</span>
          <input type="number" id="coins10H" min="0" value="0" disabled />
        </label>
      </div>
      <div class="grid3" style="margin-top:10px">
        <label>
          <span>Dragon 20 Normal — Energy Planned</span>
          <input type="number" id="energy20N" min="0" placeholder="e.g., 5000" />
        </label>
        <label>
          <span>Coins per Energy (20N)</span>
          <input type="number" id="cpe20N" min="0" step="0.01" placeholder="editable e.g., 0.55" />
        </label>
        <label>
          <span>Subtotal Coins (20N)</span>
          <input type="number" id="coins20N" min="0" value="0" disabled />
        </label>
      </div>
      <p class="muted" style="margin-top:8px">Set your own <em>Coins per Energy</em> assumptions for 10H and 20N (these will differ by your drop luck & stage). The subtotals update live.</p>
    </div>

    <div class="section panel">
      <h3>Shards You Plan to Use</h3>
      <div class="grid2">
        <label>
          <span>Mystery Shards ×</span>
          <input type="number" id="mysteryQty" min="0" placeholder="0" />
        </label>
        <label>
          <span>Ancient Shards ×</span>
          <input type="number" id="ancientQty" min="0" placeholder="0" />
        </label>
      </div>
      <div class="grid2" style="margin-top:10px">
        <label>
          <span>Void Shards ×</span>
          <input type="number" id="voidQty" min="0" placeholder="0" />
        </label>
        <label>
          <span>Primal Shards ×</span>
          <input type="number" id="primalQty" min="0" placeholder="0" />
        </label>
      </div>
      <div class="grid2" style="margin-top:10px">
        <label>
          <span>Sacred Shards ×</span>
          <input type="number" id="sacredQty" min="0" placeholder="0" />
        </label>
        <div></div>
      </div>
      <p class="muted">Shard coin values (fixed): Mystery 3 • Ancient 300 • Void 750 • Primal 2700 • Sacred 4500.</p>
    </div>

    <div class="section panel">
      <h3>Milestones</h3>
      <div id="milestones"></div>
    </div>
  </main>

  <script>
    const $ = (s,c=document)=>c.querySelector(s);
    const num = v => Number(v||0) || 0;
    const fmt = n => n.toLocaleString(undefined,{maximumFractionDigits:0});

    const MILESTONES = [
      { name: '1 Key + 25 Fragments', pts: 18000 },
      { name: '2nd Key + 25 Fragments', pts: 24000 },
      { name: '1 Soul (Raphael/April)', pts: 57500 },
      { name: 'Both Souls', pts: 115000 },
    ];

    const els = {
      goalSelect: $('#goalSelect'),
      pointsNeeded: $('#pointsNeeded'),
      currentPoints: $('#currentPoints'),
      remainingPoints: $('#remainingPoints'),
      progressBar: $('#progressBar'),
      targetInput: $('#targetInput'),
      alreadyCoins: $('#alreadyCoins'),
      // energy
      energy10H: $('#energy10H'), cpe10H: $('#cpe10H'), coins10H: $('#coins10H'),
      energy20N: $('#energy20N'), cpe20N: $('#cpe20N'), coins20N: $('#coins20N'),
      // shards
      mysteryQty: $('#mysteryQty'), ancientQty: $('#ancientQty'), voidQty: $('#voidQty'), primalQty: $('#primalQty'), sacredQty: $('#sacredQty'),
      milestones: $('#milestones'),
    };

    const SHARD_POINTS = { mystery:3, ancient:300, void:750, primal:2700, sacred:4500 };

    const state = {
      target: 115000,
      already: 0,
      energy: { e10H:0, cpe10H:0, e20N:0, cpe20N:0 },
      shards: { mystery:0, ancient:0, void:0, primal:0, sacred:0 },
    };

    function coinsFromEnergy(){
      const a = num(state.energy.e10H) * num(state.energy.cpe10H);
      const b = num(state.energy.e20N) * num(state.energy.cpe20N);
      return Math.floor(a + b);
    }

    function coinsFromShards(){
      const s = state.shards;
      return (
        num(s.mystery)*SHARD_POINTS.mystery +
        num(s.ancient)*SHARD_POINTS.ancient +
        num(s.void)*SHARD_POINTS.void +
        num(s.primal)*SHARD_POINTS.primal +
        num(s.sacred)*SHARD_POINTS.sacred
      );
    }

    function totalPlanned(){
      return num(state.already) + coinsFromEnergy() + coinsFromShards();
    }

    function renderMilestones(total){
      els.milestones.innerHTML = '';
      MILESTONES.forEach(ms=>{
        const reached = total >= ms.pts;
        const left = Math.max(0, ms.pts - total);
        const row = document.createElement('div');
        row.style.display='flex';
        row.style.justifyContent='space-between';
        row.style.alignItems='center';
        row.style.background='#111525';
        row.style.border='1px solid #273047';
        row.style.borderRadius='12px';
        row.style.padding='10px 12px';
        row.innerHTML = `<div style="font-weight:700">${ms.name}</div><div style="color:#8b93a7">${reached? '✅ Reached' : '⏳ ' + fmt(left) + ' Pumpkin Coins left'}</div>`;
        els.milestones.appendChild(row);
      })
    }

    function update(){
      // Energy subtotals
      els.coins10H.value = Math.floor(num(state.energy.e10H)*num(state.energy.cpe10H));
      els.coins20N.value = Math.floor(num(state.energy.e20N)*num(state.energy.cpe20N));

      const planned = totalPlanned();
      const target = num(state.target);

      els.currentPoints.textContent = fmt(planned);
      els.pointsNeeded.textContent = fmt(target);
      const remaining = Math.max(0, target - planned);
      els.remainingPoints.textContent = fmt(remaining);
      const pct = target>0? Math.min(100,(planned/target)*100):0;
      els.progressBar.style.width = pct + '%';

      renderMilestones(planned);
    }

    function bind(){
      els.goalSelect.addEventListener('change', ()=>{ state.target = num(els.goalSelect.value); els.targetInput.value = ''; update(); });
      els.targetInput.addEventListener('input', ()=>{ const v=num(els.targetInput.value); state.target = v>0? v : num(els.goalSelect.value); update(); });
      els.alreadyCoins.addEventListener('input', ()=>{ state.already = num(els.alreadyCoins.value); update(); });

      // energy
      els.energy10H.addEventListener('input', ()=>{ state.energy.e10H = num(els.energy10H.value); update(); });
      els.cpe10H.addEventListener('input', ()=>{ state.energy.cpe10H = num(els.cpe10H.value); update(); });
      els.energy20N.addEventListener('input', ()=>{ state.energy.e20N = num(els.energy20N.value); update(); });
      els.cpe20N.addEventListener('input', ()=>{ state.energy.cpe20N = num(els.cpe20N.value); update(); });

      // shards
      els.mysteryQty.addEventListener('input', ()=>{ state.shards.mystery = num(els.mysteryQty.value); update(); });
      els.ancientQty.addEventListener('input', ()=>{ state.shards.ancient = num(els.ancientQty.value); update(); });
      els.voidQty.addEventListener('input', ()=>{ state.shards.void = num(els.voidQty.value); update(); });
      els.primalQty.addEventListener('input', ()=>{ state.shards.primal = num(els.primalQty.value); update(); });
      els.sacredQty.addEventListener('input', ()=>{ state.shards.sacred = num(els.sacredQty.value); update(); });
    }

    // init defaults
    function init(){
      // start with blank CPE so creators can set their own assumptions
      els.cpe10H.value = '';
      els.cpe20N.value = '';
      bind();
      update();
    }

    init();
  </script>
</body>
</html>
